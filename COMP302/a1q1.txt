open Real

fun sumlist [] = 0.0
  | sumlist (x::xs) = x + sumlist(xs)

fun squarelist [] = []
  | squarelist ((x:real)::xs) = (x*x)::(squarelist(xs))

(* The following functions assume that the list in not empty.*)
fun mean l = sumlist(l)/(fromInt(length(l)))

fun difflist([],x:real) = []
  | difflist ((x:real)::xs, m) = ((x - m)::difflist (xs, m))

fun variance l = sumlist(squarelist(difflist(l, mean(l))))/(fromInt(length(l)))